<template><div><nav class="table-of-contents"><ul><li><router-link to="#swagger-配置">Swagger 配置</router-link><ul><li><router-link to="#_1-安装依赖">1. 安装依赖</router-link></li><li><router-link to="#_2-配置-swagger">2. 配置 Swagger</router-link></li></ul></li><li><router-link to="#dto-配置">DTO 配置</router-link><ul><li><router-link to="#_1-用户-dto">1. 用户 DTO</router-link></li><li><router-link to="#_2-图片-dto">2. 图片 DTO</router-link></li></ul></li><li><router-link to="#实体配置">实体配置</router-link><ul><li><router-link to="#_1-用户实体">1. 用户实体</router-link></li><li><router-link to="#_2-图片实体">2. 图片实体</router-link></li></ul></li><li><router-link to="#控制器配置">控制器配置</router-link><ul><li><router-link to="#_1-用户控制器">1. 用户控制器</router-link></li><li><router-link to="#_2-图片控制器">2. 图片控制器</router-link></li></ul></li><li><router-link to="#下一步">下一步</router-link></li></ul></nav>
<h1 id="nestjs-swagger-api-文档配置" tabindex="-1"><a class="header-anchor" href="#nestjs-swagger-api-文档配置"><span>NestJS Swagger API 文档配置</span></a></h1>
<h2 id="swagger-配置" tabindex="-1"><a class="header-anchor" href="#swagger-配置"><span>Swagger 配置</span></a></h2>
<h3 id="_1-安装依赖" tabindex="-1"><a class="header-anchor" href="#_1-安装依赖"><span>1. 安装依赖</span></a></h3>
<div class="language-bash line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-bash"><code><span class="line"><span class="line"><span style="color:#616E88"># 安装 Swagger 相关依赖</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">npm</span><span style="color:#A3BE8C"> install</span><span style="color:#A3BE8C"> @nestjs/swagger</span><span style="color:#A3BE8C"> swagger-ui-express</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-配置-swagger" tabindex="-1"><a class="header-anchor" href="#_2-配置-swagger"><span>2. 配置 Swagger</span></a></h3>
<p>修改 <code v-pre>src/main.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> NestFactory</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/core</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> SwaggerModule</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> DocumentBuilder</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> ValidationPipe</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/common</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> AppModule</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./app.module</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">async</span><span style="color:#81A1C1"> function</span><span style="color:#88C0D0"> bootstrap</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  const</span><span style="color:#D8DEE9"> app</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> await</span><span style="color:#D8DEE9"> NestFactory</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">create</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">AppModule</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#616E88">  // 全局管道</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  app</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">useGlobalPipes</span><span style="color:#D8DEE9FF">(</span><span style="color:#81A1C1">new</span><span style="color:#88C0D0"> ValidationPipe</span><span style="color:#D8DEE9FF">())</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#616E88">  // Swagger 配置</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  const</span><span style="color:#D8DEE9"> config</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> new</span><span style="color:#88C0D0"> DocumentBuilder</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    .</span><span style="color:#88C0D0">setTitle</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">图片服务 API</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    .</span><span style="color:#88C0D0">setDescription</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">图片服务系统的 API 文档</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    .</span><span style="color:#88C0D0">setVersion</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">1.0</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    .</span><span style="color:#88C0D0">addBearerAuth</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    .</span><span style="color:#88C0D0">build</span><span style="color:#D8DEE9FF">()</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  const</span><span style="color:#D8DEE9"> document</span><span style="color:#81A1C1"> =</span><span style="color:#D8DEE9"> SwaggerModule</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">createDocument</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">app</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> config</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  SwaggerModule</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">setup</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">api</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> app</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> document</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  await</span><span style="color:#D8DEE9"> app</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">listen</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">3000</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">bootstrap</span><span style="color:#D8DEE9FF">()</span><span style="color:#81A1C1">;</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="dto-配置" tabindex="-1"><a class="header-anchor" href="#dto-配置"><span>DTO 配置</span></a></h2>
<h3 id="_1-用户-dto" tabindex="-1"><a class="header-anchor" href="#_1-用户-dto"><span>1. 用户 DTO</span></a></h3>
<p>创建 <code v-pre>src/modules/user/dto/create-user.dto.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> ApiProperty</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> IsString</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> IsEmail</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> MinLength</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">class-validator</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> CreateUserDto</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">用户名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> example</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">john_doe</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @MinLength</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">3</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  username</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">邮箱</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> example</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">john@example.com</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsEmail</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  email</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">密码</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> example</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">password123</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @MinLength</span><span style="color:#D8DEE9FF">(</span><span style="color:#B48EAD">6</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  password</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建 <code v-pre>src/modules/user/dto/update-user.dto.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> ApiProperty</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> IsString</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> IsEmail</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> IsOptional</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">class-validator</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> UpdateUserDto</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">用户名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> required</span><span style="color:#ECEFF4">:</span><span style="color:#81A1C1"> false</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsOptional</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  username</span><span style="color:#81A1C1">?:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">邮箱</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> required</span><span style="color:#ECEFF4">:</span><span style="color:#81A1C1"> false</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsEmail</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsOptional</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  email</span><span style="color:#81A1C1">?:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-图片-dto" tabindex="-1"><a class="header-anchor" href="#_2-图片-dto"><span>2. 图片 DTO</span></a></h3>
<p>创建 <code v-pre>src/modules/photo/dto/create-photo.dto.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> ApiProperty</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> IsString</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> IsNumber</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> IsBoolean</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> IsOptional</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">class-validator</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> CreatePhotoDto</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  filename</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">原始文件名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  originalname</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件类型</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  mimetype</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件大小</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsNumber</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  size</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> number</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件路径</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsString</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  path</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">是否公开</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> default</span><span style="color:#ECEFF4">:</span><span style="color:#81A1C1"> false</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsBoolean</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @IsOptional</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  isPublic</span><span style="color:#81A1C1">?:</span><span style="color:#8FBCBB"> boolean</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实体配置" tabindex="-1"><a class="header-anchor" href="#实体配置"><span>实体配置</span></a></h2>
<h3 id="_1-用户实体" tabindex="-1"><a class="header-anchor" href="#_1-用户实体"><span>1. 用户实体</span></a></h3>
<p>修改 <code v-pre>src/modules/user/entities/user.entity.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Entity</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Column</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  PrimaryGeneratedColumn</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  CreateDateColumn</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  UpdateDateColumn</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  OneToMany</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">typeorm</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> Exclude</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">class-transformer</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> ApiProperty</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> Photo</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../../photo/entities/photo.entity</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@Entity</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">users</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> User</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">用户ID</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @PrimaryGeneratedColumn</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">uuid</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">用户名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> unique</span><span style="color:#ECEFF4">:</span><span style="color:#81A1C1"> true</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  username</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">邮箱</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> unique</span><span style="color:#ECEFF4">:</span><span style="color:#81A1C1"> true</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  email</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Exclude</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  password</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">用户角色</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> default</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">user</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  role</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @OneToMany</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> =></span><span style="color:#D08770"> Photo</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> (</span><span style="color:#D8DEE9">photo</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =></span><span style="color:#D8DEE9"> photo</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">user</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  photos</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> Photo</span><span style="color:#D8DEE9FF">[]</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">创建时间</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @CreateDateColumn</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  createdAt</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> Date</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">更新时间</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @UpdateDateColumn</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  updatedAt</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> Date</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-图片实体" tabindex="-1"><a class="header-anchor" href="#_2-图片实体"><span>2. 图片实体</span></a></h3>
<p>修改 <code v-pre>src/modules/photo/entities/photo.entity.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Entity</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Column</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  PrimaryGeneratedColumn</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  CreateDateColumn</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  UpdateDateColumn</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ManyToOne</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">typeorm</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> ApiProperty</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> User</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../../user/entities/user.entity</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@Entity</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">photos</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> Photo</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">图片ID</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @PrimaryGeneratedColumn</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">uuid</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  filename</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">原始文件名</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  originalname</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件类型</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  mimetype</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件大小</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  size</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> number</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">文件路径</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  path</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">是否公开</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Column</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> default</span><span style="color:#ECEFF4">:</span><span style="color:#81A1C1"> false</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  isPublic</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> boolean</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">上传用户</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ManyToOne</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> =></span><span style="color:#D08770"> User</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> (</span><span style="color:#D8DEE9">user</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> =></span><span style="color:#D8DEE9"> user</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">photos</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  user</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> User</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">创建时间</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @CreateDateColumn</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  createdAt</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> Date</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiProperty</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">更新时间</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @UpdateDateColumn</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9FF">  updatedAt</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> Date</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="控制器配置" tabindex="-1"><a class="header-anchor" href="#控制器配置"><span>控制器配置</span></a></h2>
<h3 id="_1-用户控制器" tabindex="-1"><a class="header-anchor" href="#_1-用户控制器"><span>1. 用户控制器</span></a></h3>
<p>修改 <code v-pre>src/modules/user/user.controller.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Controller</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Get</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Post</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Body</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Patch</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Param</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Delete</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  UseGuards</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/common</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> UserService</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./user.service</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> CreateUserDto</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./dto/create-user.dto</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> UpdateUserDto</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./dto/update-user.dto</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> JwtAuthGuard</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../auth/guards/jwt-auth.guard</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> RolesGuard</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../auth/guards/roles.guard</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> Roles</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../auth/decorators/roles.decorator</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiTags</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiOperation</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiBearerAuth</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiResponse</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> User</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./entities/user.entity</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@ApiTags</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">用户管理</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@Controller</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">users</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@UseGuards</span><span style="color:#D8DEE9FF">(</span><span style="color:#D08770">JwtAuthGuard</span><span style="color:#ECEFF4">,</span><span style="color:#D08770"> RolesGuard</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@ApiBearerAuth</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> UserController</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  constructor</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">private</span><span style="color:#81A1C1"> readonly</span><span style="color:#D8DEE9"> userService</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> UserService</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Post</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Roles</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">admin</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">创建用户</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 201</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">创建成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D08770"> User</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  create</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Body</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">createUserDto</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> CreateUserDto</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">userService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">create</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">createUserDto</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Get</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Roles</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">admin</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取所有用户</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D08770">User</span><span style="color:#D8DEE9FF">] </span><span style="color:#ECEFF4">}</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  findAll</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">userService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">findAll</span><span style="color:#D8DEE9FF">()</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Get</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">:id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取指定用户</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D08770"> User</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  findOne</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Param</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">) </span><span style="color:#D8DEE9">id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">userService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">findOne</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">id</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Patch</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">:id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">更新用户信息</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">更新成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D08770"> User</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  update</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Param</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">) </span><span style="color:#D8DEE9">id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#ECEFF4">,</span><span style="color:#D08770"> @Body</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">updateUserDto</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> UpdateUserDto</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">userService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">update</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">id</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> updateUserDto</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Delete</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">:id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Roles</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">admin</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">删除用户</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">删除成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  remove</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Param</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">) </span><span style="color:#D8DEE9">id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">userService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">remove</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">id</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-图片控制器" tabindex="-1"><a class="header-anchor" href="#_2-图片控制器"><span>2. 图片控制器</span></a></h3>
<p>修改 <code v-pre>src/modules/photo/photo.controller.ts</code>：</p>
<div class="language-typescript line-numbers-mode line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre  class="shiki nord vp-code" style="background-color:#2e3440ff;color:#d8dee9ff" v-pre=" language-typescript"><code><span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Controller</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Get</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Post</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Body</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Patch</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Param</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Delete</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  UseGuards</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  UseInterceptors</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  UploadedFile</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  Request</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/common</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> FileInterceptor</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/platform-express</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> PhotoService</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./photo.service</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> CreatePhotoDto</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./dto/create-photo.dto</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> UpdatePhotoDto</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./dto/update-photo.dto</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> JwtAuthGuard</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../auth/guards/jwt-auth.guard</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> multerConfig</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">../../config/multer.config</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiTags</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiOperation</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiBearerAuth</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiConsumes</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiBody</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">  ApiResponse</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">@nestjs/swagger</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> Photo</span><span style="color:#ECEFF4"> }</span><span style="color:#81A1C1"> from</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">./entities/photo.entity</span><span style="color:#ECEFF4">"</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@ApiTags</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">图片管理</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@Controller</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">photos</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@UseGuards</span><span style="color:#D8DEE9FF">(</span><span style="color:#D08770">JwtAuthGuard</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">@ApiBearerAuth</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">export</span><span style="color:#81A1C1"> class</span><span style="color:#8FBCBB"> PhotoController</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  constructor</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">private</span><span style="color:#81A1C1"> readonly</span><span style="color:#D8DEE9"> photoService</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> PhotoService</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {}</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Post</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">upload</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @UseInterceptors</span><span style="color:#D8DEE9FF">(</span><span style="color:#D08770">FileInterceptor</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">file</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D08770"> multerConfig</span><span style="color:#D8DEE9FF">))</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiConsumes</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">multipart/form-data</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiBody</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">    schema</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      type</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">object</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      properties</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">        file</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">          type</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">string</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">          format</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">binary</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">        },</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">      },</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    },</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">上传图片</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 201</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">上传成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D08770"> Photo</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">  async</span><span style="color:#88C0D0"> uploadFile</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@UploadedFile</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">file</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> Express</span><span style="color:#ECEFF4">.</span><span style="color:#8FBCBB">Multer</span><span style="color:#ECEFF4">.</span><span style="color:#8FBCBB">File</span><span style="color:#ECEFF4">,</span><span style="color:#D08770"> @Request</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">req</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    const</span><span style="color:#D8DEE9"> createPhotoDto</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> CreatePhotoDto</span><span style="color:#81A1C1"> =</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      filename</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> file</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">filename</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      originalname</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> file</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">originalname</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      mimetype</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> file</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">mimetype</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      size</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> file</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">size</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D8DEE9">      path</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> file</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">path</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">    }</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">photoService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">create</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">createPhotoDto</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> req</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">user</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Get</span><span style="color:#D8DEE9FF">()</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取图片列表</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9FF"> [</span><span style="color:#D08770">Photo</span><span style="color:#D8DEE9FF">] </span><span style="color:#ECEFF4">}</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  findAll</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Request</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">req</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">photoService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">findAll</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">req</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">user</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Get</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">:id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取指定图片</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">获取成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D08770"> Photo</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  findOne</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Param</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">) </span><span style="color:#D8DEE9">id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#ECEFF4">,</span><span style="color:#D08770"> @Request</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">req</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">photoService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">findOne</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">id</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> req</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">user</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Patch</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">:id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">更新图片信息</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">更新成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> type</span><span style="color:#ECEFF4">:</span><span style="color:#D08770"> Photo</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  update</span><span style="color:#ECEFF4">(</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">    @Param</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">) </span><span style="color:#D8DEE9">id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">    @Body</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">updatePhotoDto</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> UpdatePhotoDto</span><span style="color:#ECEFF4">,</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">    @Request</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">req</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  )</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">photoService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">update</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">id</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> updatePhotoDto</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> req</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">user</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @Delete</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">:id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiOperation</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> summary</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">删除图片</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#D08770">  @ApiResponse</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> status</span><span style="color:#ECEFF4">:</span><span style="color:#B48EAD"> 200</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> description</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">删除成功</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4"> }</span><span style="color:#D8DEE9FF">)</span></span></span>
<span class="line"><span class="line"><span style="color:#88C0D0">  remove</span><span style="color:#ECEFF4">(</span><span style="color:#D08770">@Param</span><span style="color:#D8DEE9FF">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">id</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">) </span><span style="color:#D8DEE9">id</span><span style="color:#81A1C1">:</span><span style="color:#8FBCBB"> string</span><span style="color:#ECEFF4">,</span><span style="color:#D08770"> @Request</span><span style="color:#D8DEE9FF">() </span><span style="color:#D8DEE9">req</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span></span>
<span class="line"><span class="line"><span style="color:#81A1C1">    return</span><span style="color:#81A1C1"> this</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">photoService</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">remove</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">id</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> req</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">user</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">;</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">  }</span></span></span>
<span class="line"><span class="line"><span style="color:#ECEFF4">}</span></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="下一步" tabindex="-1"><a class="header-anchor" href="#下一步"><span>下一步</span></a></h2>
<p>在下一篇文章中，我们将介绍：</p>
<ol>
<li>邮件服务集成</li>
<li>邮件模板设计</li>
<li>定时任务实现</li>
<li>邮件队列管理</li>
</ol>
<p>敬请期待！</p>
</div></template>


